<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>DC Metro Network Analysis - Kevin Craig</title><meta name="Description" content="Network Analysis of DC Metro System"><meta property="og:title" content="DC Metro Network Analysis" />
<meta property="og:description" content="Network Analysis of DC Metro System" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kevcraig.github.io/dc-metro-analysis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-13T16:29:41+08:00" />
<meta property="article:modified_time" content="2021-12-27T16:29:41+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="DC Metro Network Analysis"/>
<meta name="twitter:description" content="Network Analysis of DC Metro System"/>
<meta name="application-name" content="Kevin Craig">
<meta name="apple-mobile-web-app-title" content="Kevin Craig"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://kevcraig.github.io/dc-metro-analysis/" /><link rel="prev" href="https://kevcraig.github.io/switch-to-blogdown/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "DC Metro Network Analysis",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/kevcraig.github.io\/dc-metro-analysis\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/kevcraig.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","wordcount":  830 ,
        "url": "https:\/\/kevcraig.github.io\/dc-metro-analysis\/","datePublished": "2021-04-13T16:29:41+08:00","dateModified": "2021-12-27T16:29:41+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/kevcraig.github.io\/images\/avatar.png",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Kevin"
            },"description": "Network Analysis of DC Metro System"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kevin Craig">Kevin Craig</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/posts/"> Posts &amp; Projects </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kevin Craig">Kevin Craig</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/posts/" title="">Posts &amp; Projects</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animated flipInX">DC Metro Network Analysis</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Kevin</a></span>&nbsp;<span class="post-category">included in <a href="/categories/projects/"><i class="far fa-folder fa-fw"></i>Projects</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-04-13">2021-04-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;830 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="content" id="content"><p>Network analysis is often applied to the social and online systems around us, for example, Facebook friend networks. A more concrete example of a physical network, however, is a metro system.</p>
<p>The DC metro is a straightforward example of a fully connected network system. The network can be described as nodes (stations) and edges (railway paths). With each additional connection to other stations, a station&rsquo;s importance to the network becomes more critical.</p>
<p>Given this information, how can we understand the importance of each metro station? Metro nodes can be described with three main metrics:</p>
<ol>
<li>
<p><strong>Degree</strong>: How many other stations a rider can reach from a given station</p>
</li>
<li>
<p><strong>Betweenness Centrality</strong>: How much control a station has on the ability for a rider to reach other stations</p>
</li>
<li>
<p><strong>Closeness Centrality:</strong></b> How close a given station is to other stations</p>
</li>
</ol>
<p>To understand the degree, betweenness, and closeness of a given station, we first need to represent the metro system in a dataset that the computer can understand. The best way to accomplish this is through an adjacency matrix of stations. Luckily, the Washington Metropolitan Area Transit Authority (WMATA) provides a series of <a href="https://developer.wmata.com" target="_blank" rel="noopener noreffer">API products</a> that make the fetching of station and line data easy. Code for how to build the adjacency matrix is in my <a href="https://github.com/kevcraig/DC-Metro-Analysis/blob/main/Get%20Metro%20Data.py" target="_blank" rel="noopener noreffer">Github Repo</a>. I was surprised this data was not available anywhere I looked online, so I hope it is useful for anyone else who wants to explore metro analytics.</p>
<p>Once the network is expressed in an adjacency matrix, Python can help us calculate the network statistics discussed above. Finally, we can overlay those stats on top of network line and station shapefiles provided by WMATA and visualized via geopandas. Hover over points to view node statistics and press the magnifying glass to zoom.</p>
<div align = "center">
	<iframe src="bokeh_wmata.html" frameborder="0" width="600" height="530"	></iframe>
</div>
<p>Before I started this project, I assumed Metro Center would be the most <em>important</em> station based on my ridership patterns while living in DC. However, given the findings on this analysis, it looks like L&rsquo;Enfant Plaza is the most important! L&rsquo;Enfant has a degree of 5, betweenness of .571, and closeness of .144, not to mention an underground food court. Honorable mention goes to the Pentagon, the most important station outside of DC in terms of betweenness and closeness centrality.</p>
<p>Instead of using set shapefiles to draw the network, what if we let the computer decide how it should look? Force-directed algorithms allow us to visualize networks as nodes and edges that repel against each other based on a given charge. The D3 JavaScript library is a popular tool for building force-directed networks — I implemented D3 to create a free-flowing DC metro system below. Pull a node with your mouse and watch the network update positions.</p>
<div style="width:960; margin:0 auto;">
<style>

	.links line {
	  stroke: #999;
	  stroke-opacity: 0.6;
	}
	
	.nodes circle {
	  stroke: #fff;
	  stroke-width: 1.5px;
	}
	
	text {
	  font-family: sans-serif;
	  font-size: 8px;
	}
	
	
	</style>
<script src="https://d3js.org/d3.v4.min.js"></script>
<p><svg width="960" height="800"></svg></p>
<script>


var svg = d3.select("svg"),
	width = +svg.attr("width"),
	height = +svg.attr("height");

var color = d3.scaleOrdinal(d3.schemeCategory20);

var simulation = d3.forceSimulation()
	.force("link", d3.forceLink().id(function(d) { return d.id; }))
	.force("charge", d3.forceManyBody().strength(-15))
	.force("center", d3.forceCenter(width / 2, height / 2));

d3.json("wmata.json", function(error, graph) {
  if (error) throw error;

  var link = svg.append("g")
	  .attr("class", "links")
	.selectAll("line")
	.data(graph.links)
	.enter().append("line")
	  .attr("stroke-width", function(d) { return Math.sqrt(d.degree); });

  var node = svg.append("g")
	  .attr("class", "nodes")
	.selectAll("g")
	.data(graph.nodes)
	.enter().append("g")
	
  var circles = node.append("circle")
	  .attr("r", function(d) { return d.degree * 3; })
	  .attr("fill", function(d) { return color(d.degree); })
	  .call(d3.drag()
		  .on("start", dragstarted)
		  .on("drag", dragged)
		  .on("end", dragended));

  var lables = node.append("text")
	  .text(function(d) {
		return d.id;
	  })
	  .attr('x', 6)
	  .attr('y', 3);

  node.append("title")
	  .text(function(d) { return d.id; });

  simulation
	  .nodes(graph.nodes)
	  .on("tick", ticked);

  simulation.force("link")
	  .links(graph.links);

  function ticked() {
	link
		.attr("x1", function(d) { return d.source.x; })
		.attr("y1", function(d) { return d.source.y; })
		.attr("x2", function(d) { return d.target.x; })
		.attr("y2", function(d) { return d.target.y; });

	node
		.attr("transform", function(d) {
		  return "translate(" + d.x + "," + d.y + ")";
		})
  }
});

function dragstarted(d) {
  if (!d3.event.active) simulation.alphaTarget(0.3).restart();
  d.fx = d.x;
  d.fy = d.y;
}

function dragged(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
}

function dragended(d) {
  if (!d3.event.active) simulation.alphaTarget(0);
  d.fx = null;
  d.fy = null;
}

</script>
</div>
<p>Through network analysis, we can understand which stations are most important in terms of degree and centrality, then visualize the network with Python Bokeh or D3. A subsequent step would be to weight the nodes and edges based on how many people flow through a station each day and where they are traveling. This would give us a better idea of node centrality and could be interesting to view through time, especially during the workday.</p>
<p>For anyone hoping to visualize networks in D3, I found that the library had a steep learning curve for someone without previous experience in JavaScript, but provided some really unique and customizable results once you got the hang of it. Using D3 with a physical network like the DC metro is kind of trivial since there is already a real physical representation, but would be very useful when visualizing social networks. A common example of D3 with social networks is <a href="https://bl.ocks.org/mbostock/4062045" target="_blank" rel="noopener noreffer">here</a> with Les Mis characters.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-12-27</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/dc-metro-analysis/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/switch-to-blogdown/" class="prev" rel="prev" title="Switch to Blogdown"><i class="fas fa-angle-left fa-fw"></i>Switch to Blogdown</a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2022</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
